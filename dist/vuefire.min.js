/*!
 * vuefire v2.0.0-alpha.7
 * (c) 2018 Eduardo San Martin Morote
 * Released under the MIT License.
 */
!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(i.Vuefire={})}(this,function(i){"use strict";var t=function(i,t,e,n,o){this.vm=i,this.key=t,this.source=e,this.onReady=n,this.onError=o,this.initialValue=null};t.prototype.bind=function(){throw new Error("[bind] must be implemented in children.")},t.prototype._init=function(i){this.defineReactive(this.vm,this.key,i)},t.prototype.unbind=function(){this.off&&this.off(),this.vm[this.key]=this.initialValue};function e(i){if("function"!=typeof i)throw new Error("Must pass a function.");var t=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];i.apply(void 0,e),t=function(){}};return t}function n(i){var t=i.exists?i.data():{};return t[".id"]=i.id,t}function o(i){for(var t=[];i;)t.unshift(i.id),i=i.parent;var e=i.firestore._databaseId;return t.unshift(e.database),t.unshift(e.projectId),i.firebase.segments.join("/")}var r=function(i){function t(t,e,n,o,r){if(i.apply(this,arguments),!this.source.firestore||!this.source.collection)throw new Error("Not a valid Firestore DocumentReference to bind.");this.initialValue={}}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.path=function(){return o(this.source)},t.prototype.init=function(){this.onReadyOnce=e(this.onReady),this._init(this.initialValue)},t.prototype.bind=function(){var i=this.source.onSnapshot(function(i){this.vm[this.key]=n(i),this.onReadyOnce()},this.onError);this.off=e(i)},t}(t),s=function(i){function t(t,e,n,o,r){if(i.apply(this,arguments),!this.source.firestore||!this.source.where)throw new Error("Not a valid Firestore CollectionReference or Query to bind.");this.initialValue=[]}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.path=function(){return o(this.source)},t.prototype.init=function(){this.onReadyOnce=e(this.onReady),this._init(this.initialValue)},t.prototype.bind=function(){this.unbind();var i=this.source.onSnapshot(function(i){var t=this;i.docChanges.forEach(function(i){switch(i.type){case"added":t.array.splice(i.newIndex,0,n(i.doc));break;case"modified":var e=n(i.doc);i.oldIndex===i.newIndex?t.array.splice(i.oldIndex,1,e):(t.array.splice(i.oldIndex,1),t.array.splice(i.newIndex,0,e));break;case"removed":t.array.splice(i.oldIndex,1)}}),this.onReadyOnce()},this.onError);this.off=e(i)},t}(t);function a(i){return"function"==typeof i.key?i.key():i.key}function c(i){return"[object Object]"===Object.prototype.toString.call(i)}function u(i,t){for(var e=0;e<i.length;e++)if(i[e][".key"]===t)return e;return-1}function f(i){var t=i.val(),e=c(t)?t:{".value":t};return e[".key"]=a(i),e}var h,d=function(i){function t(t,e,n,o,r){if(i.apply(this,arguments),"function"!=typeof this.source.on)throw new Error("Not a valid source to bind.");this.initialValue=[]}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.init=function(){this._init(this.initialValue)},t.prototype.bind=function(){this.unbind();var i=this.source.on("child_added",function(i,t){var e=t?u(this.initialValue,t)+1:0;this.initialValue.splice(e,0,f(i))},this.onError),t=this.source.on("child_removed",function(i){var t=u(this.initialValue,a(i));this.initialValue.splice(t,1)},this.onError),n=this.source.on("child_changed",function(i){var t=u(this.initialValue,a(i));this.initialValue.splice(t,1,f(i))},this.onError),o=this.source.on("child_moved",function(i,t){var e=u(this.initialValue,a(i)),n=this.initialValue.splice(e,1)[0],o=t?u(this.initialValue,t)+1:0;this.initialValue.splice(o,0,n)},this.onError);this.off=e(function(){this.source.off("child_added",i),this.source.off("child_removed",t),this.source.off("child_changed",n),this.source.off("child_moved",o)}),this.source.once("value",this.onReady.bind(this.vm))},t}(t),l=function(i){function t(t,e,n,o,r){if(i.apply(this,arguments),"function"!=typeof this.source.on)throw new Error("Not a valid source to bind.");this.initialValue={}}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.init=function(){this._init(this.initialValue)},t.prototype.bind=function(){this.unbind();var i=this.source.on("value",function(i){this.vm[this.key]=f(i)},this.onError);this.source.once("value",this.onReady),this.off=e(function(){this.source.off("value",i)})},t}(t);t.prototype.defineReactive=function(i,t,e){t in i?i[t]=e:h.util.defineReactive(i,t,e)};function p(i,t,e){var n=!1,o=null,a=null;if(c(e)&&e.hasOwnProperty("source")&&(n=e.asObject,o=e.cancelCallback,a=e.readyCallback,e=e.source),!c(e))throw new Error("VueFire: invalid Firebase binding source.");o=o||function(){},a=a||function(){};var u=new(n?e.firestore?r:l:e.firestore?s:d)(i,t,e,a.bind(i),o.bind(i));u.init(),u.bind(),i.$firebaseBinders[t]=u}function y(i){i.$firebaseBinders||(i.$firebaseBinders=Object.create(null))}var b={created:function(){y(this);var i=this.$options.firebase;if("function"==typeof i&&(i=i.call(this)),i)for(var t in i)p(this,t,i[t])},beforeDestroy:function(){if(this.$firebaseBinders){for(var i in this.$firebaseBinders)this.$firebaseBinders[i]&&this.$unbind(i);this.$firebaseBinders=null}}};function v(i){(h=i).mixin(b);var t=h.config.optionMergeStrategies;t.firebase=t.provide,h.prototype.$bindAsObject=function(i,t,e,n){y(this),p(this,i,{source:t,asObject:!0,cancelCallback:e,readyCallback:n})},h.prototype.$bindAsArray=function(i,t,e,n){y(this),p(this,i,{source:t,cancelCallback:e,readyCallback:n})},h.prototype.$unbind=function(i){!function(i,t){var e=i.$firebaseBinders[t];e&&e.unbind()}(this,i)}}"undefined"!=typeof window&&window.Vue&&v(window.Vue),i.default=v,Object.defineProperty(i,"__esModule",{value:!0})});